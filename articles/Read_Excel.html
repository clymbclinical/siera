<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Read ARS from Excel • siera</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Read ARS from Excel">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">siera</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/ARS_background.html">ARS_background</a></li>
    <li><a class="dropdown-item" href="../articles/Read_Excel.html">Read ARS from Excel</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Read ARS from Excel</h1>
                        <h4 data-toc-skip class="author">Malan
Bosman</h4>
            
            <h4 data-toc-skip class="date">2025-07-09</h4>
      

      <div class="d-none name"><code>Read_Excel.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="ars-metadata-in-excel">ARS Metadata in Excel<a class="anchor" aria-label="anchor" href="#ars-metadata-in-excel"></a>
</h2>
<p>The official CDISC ARS metadata is represented in JSON format,
allowing language-agnostic and efficient data transfer. However, there
is an unofficial representation of ARS metadata in Excel, which has the
benefit of being more easily human readable (and directly editable if
needed). An example of such an Excel ARS sheet for the CDISC Pilot study
can be found <a href="https://github.com/cdisc-org/analysis-results-standard/blob/main/workfiles/examples/ARS%20v1/Common%20Safety%20Displays.xlsx" class="external-link">here</a></p>
</div>
<div class="section level2">
<h2 id="reading-in-excel-ars-metadata---what-to-expect">Reading in Excel ARS metadata - what to expect<a class="anchor" aria-label="anchor" href="#reading-in-excel-ars-metadata---what-to-expect"></a>
</h2>
<p>The ARS metadata represented in Excel contains all ARS information
for the Reporting Event. It is divided into Excel Worksheets, roughly
mapped/equivalent to the official JSON ARS representation and its
classes (an example can be found <a href="https://github.com/cdisc-org/analysis-results-standard/blob/main/workfiles/examples/ARS%20v1/Common%20Safety%20Displays.json" class="external-link">here</a>).
For the purpose of automating Analysis Results using <em>siera</em>, a
subset of the multiple Excel Worksheets contain the key information.
These include: - <em>MainListOfContents</em> (links outputs to their
respective analyses) - <em>OtherListsOfContents</em> (contains output
metadata) - <em>DataSubsets</em> (filters data for individual analyses)
- <em>AnalysisSets</em> (filters data to get the Population Set for the
output) - <em>AnalysisGroupings</em> (groups data according to analysis
specifications) - <em>Analyses</em> (contains linking information to all
components required for calculation of results) -
<em>AnalysisMethods</em> (describes operations to be performed on data
to get results) - <em>AnalysisMethodCodeTemplate</em> (contains
dynamically written R code to perform AnalysisMethod) -
<em>AnalysisMethodCodeParameters</em> (populates
AnalysisMethodCodeTemplate with Analysis information)</p>
<div class="section level3">
<h3 id="a-note-on-example-code-used-in-analysismethodcodetemplate">A note on example code used in AnalysisMethodCodeTemplate<a class="anchor" aria-label="anchor" href="#a-note-on-example-code-used-in-analysismethodcodetemplate"></a>
</h3>
<p>A powerful aspect of the ARS model, is that dynamic code can be
supplied as part of the metadata and be evaluated on either 1. the
Output level, 2. the Analysis level, or 3. the AnalysisMethod level (for
more information on this, see <a href="https://www.lexjansen.com/phuse-us/2025/ds/PAP_DS09.pdf" class="external-link">this</a>
PHUSE paper). The latter case is implemented by making use of the
<em>AnalysisMethodCodeTemplate</em> and
<em>AnalysisMethodCodeParameters</em> classes in the metadata. The user
supplies dynamic R code (with the option of making use of parameters
referring to metadata pieces), which will be executed to perform the
relevant AnalysisMethod operations.</p>
<p>For the example ARS metadata in Excel shipped with this package, the
R code used in the <em>AnalysisMethodCodeTemplate</em> is aligned with
the <em>cards</em> R package (more information <a href="https://insightsengineering.github.io/cards/latest-tag/" class="external-link">here</a>).
The <em>cards</em> package is a reputable R package consisting of
wrappers for various statistical functions, and producing results in a
consistent ARD format. Below is a simple example of how a function
<em>ard_continuous</em> from the <em>cards</em> package is used in the
<em>AnalysisMethodCodeTemplate</em> class in the accompanying Excel ARS
metadata example shipped with this package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># example of 'cards' code in AnalysisMethodCodeTemplate, using the ard_continuous function:</span></span>
<span></span>
<span><span class="va">Analysis_ARD</span> <span class="op">=</span> <span class="fu">ard_continuous</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">filtered_ADSL</span>,</span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">byvariables_here</span><span class="op">)</span>,</span>
<span>  variables <span class="op">=</span> <span class="va">analysisvariable_here</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In the above example of <em>AnalysisMethodCodeTemplate</em> code for
a particular AnalysisMethod (summary statistics for a continuous
variable), the <em>ard_continuous</em> function from the <em>cards</em>
package is used. Notice, however, that two parameters are used in the
code:</p>
<ol style="list-style-type: decimal">
<li>‘byvariables_here’, and</li>
<li>‘analysisvariable_here’.</li>
</ol>
<p>These are example placeholder names, to be replaced by actual
variables, depending on the context for the Analysis. For example,
‘byvariables_here’ could be replaced by TRT01A, and
‘analysisvariable_here’ could be replaced by AGE, for an ARD with
summary statistics on AGE by Treatment. The same code, however, will be
reused for summary statistics on e.g. HEIGHT for another Analysis, and
the ‘analysisvariable_here’ will be replaced with HEIGHT. All this is
dynamically applied within the readARS_xl function when generating R
scripts using <em>siera</em>.</p>
</div>
</div>
<div class="section level2">
<h2 id="reading-in-excel-ars-metadata">reading in Excel ARS metadata<a class="anchor" aria-label="anchor" href="#reading-in-excel-ars-metadata"></a>
</h2>
<p>The <em>readARS_xl</em> function reads in a completed ARS metadata
Excel file, and generates R scripts for each output defined in the file.
Below is an example of how this can be done using a ready-to-use ARS
metadata Excel file:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">siera</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Path to the Excel ARS metadata file: </span></span>
<span><span class="va">ARS_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ARS_example.html">ARS_example</a></span><span class="op">(</span><span class="st">"Common_Safety_Displays_cards.xlsx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Path to a folder which will contain the output meta-programmed R scripts (recommended to update</span></span>
<span><span class="co"># to a more suitable local path)</span></span>
<span><span class="va">output_folder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Path to the folder containing ADaM datasets in csv format (we will use temporary </span></span>
<span><span class="co"># directory tempdir() to make the code run in this vignette, but it's recommended to </span></span>
<span><span class="co"># 1. download the ADaMs required (csv ADSL and ADAE available using e.g. ARS_example("ADSL.csv"))</span></span>
<span><span class="co"># 2. store it in a folder (the directly downloaded location can be found using dirname(ARS_example("ADSL.csv")), for example.  Use this location, or manually store the ADaM somewhere else)</span></span>
<span><span class="co"># 3. use the folder path instead of tempdir() below.</span></span>
<span><span class="va">ADaM_folder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># run the readARS function with these 3 parameters.  This creates R scripts </span></span>
<span><span class="co"># (1 for each output in output_folder)</span></span>
<span><span class="fu"><a href="../reference/readARS_xl.html">readARS_xl</a></span><span class="op">(</span><span class="va">ARS_path</span>, <span class="va">output_folder</span>, <span class="va">ADaM_folder</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="try-it-out">Try it out!<a class="anchor" aria-label="anchor" href="#try-it-out"></a>
</h3>
<p>If you’ve followed along in the previous section example, you should
now have 5 R scripts (named ARD_Out14-1-1.R, ARD_Out14-3-1-1.R,
ARD_Out14-3-2-1.R, ARD_Out14-3-3-1a.R, and ARD_Out14-3-3-1b.R) in the
folder specified as <em>output_folder</em>. If this is successful, you
can execute any of these 5 R scripts as-is (assuming the ADaM required
for this script is available in the <em>ADaM_folder</em>), and the
result will be an ARD (one result per row format) for each of the
scripts. This will look like this:</p>
<p>Note: each output requires one or more ADaM datasets to calculate the
results from. The code to load these csv ADaMs are automatically added
to the ARD_xxx.R script. As mentioned, some ADaMs are available using
the ARS_example(“XXXX.csv”) function. However, Output 14-3-3-1a and
Output 14-3-3-1b make use of the ADVS dataset, which is not currently
shipped with the <em>siera</em> package due to size considerations. The
relevant ADVS ADaM van can be obtained from the CDISC Pilot Study. All
other outputs use either ADSL or ADAE, which is shipped with this
package and can be accessed through</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Malan Bosman, Clymb Clinical.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
